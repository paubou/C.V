(function () {var a={data:function(){return{iconEmpty:{type:"check",back:"theme-empty"},icon:{type:"refresh",back:"theme-process"},processing:!1,completed:[],failed:[]}},props:{files:Array},computed:{count:function(){var t=this.files.length;return t=Object.is(t,void 0)?0:t,t},completedCount:function(){var t=this.completed.length;return t=Object.is(t,void 0)?0:t}},methods:{processImages:function(){var t=this;this.resetArrays(),this.processing=!0,this.files.forEach(function(e,i){t.$api.post("colorextractor/process-image",{id:e.id,index:i}).then(function(i){if(t.completed.push(e.name),t.completedCount==t.count)if(t.failed.length)t.failedExtraction();else{var s=t;setTimeout(function(){s.completedExtraction()},250)}t.setProgress()}).catch(function(i){t.completed.push(e.name),t.failed.push({name:e.filename,message:i.message}),t.completedCount==t.count&&t.failedExtraction(),t.setProgress()})})},setProgress:function(){var t=this.completedCount/this.count*100;t=Math.max(0,Math.min(100,t)),this.$refs.progress.set(t)},completedExtraction:function(){var t=this.$t("colorextractor.notification.completed",{count:this.completedCount},this.completedCount);this.$refs.dialog.close(),this.$store.dispatch("notification/success",t),this.processing=!1,this.currentIndex=0,this.files={}},failedExtraction:function(){var t=this;this.processing=!1,this.currentIndex=0,this.files=this.files.filter(function(e){return t.failed.filter(function(t){return t.name===e.filename}).length})},openDialog:function(){this.resetArrays(),this.$refs.dialog.open()},abortExtraction:function(){this.$refs.dialog.close(),this.processing=!1},resetArrays:function(){this.completed=[],this.failed=[]}}};if(typeof a==="function"){a=a.options}Object.assign(a,function(){var render=function(){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c("k-field",_vm._b({},"k-field",_vm.$attrs,false),[_vm.count==0?_c("k-list-item",{staticClass:"colorextractor-empty",attrs:{"text":_vm.$t("colorextractor.button.text.empty"),"icon":_vm.iconEmpty,"element":"div"}}):_c("k-list-item",{staticClass:"colorextractor-button",attrs:{"text":_vm.$t("colorextractor.button.text"),"icon":_vm.icon,"element":"div"},on:{"click":_vm.openDialog}}),_vm._v(" "),_c("k-dialog",{ref:"dialog",attrs:{"theme":"negative"}},[!_vm.processing&&!_vm.completedCount?[_c("k-text",{domProps:{"innerHTML":_vm._s(_vm.$t("colorextractor.dialog.text",{count:_vm.count},_vm.count))}}),_vm._v(" "),_c("template",{slot:"footer"},[_c("k-button-group",[_c("k-button",{attrs:{"icon":"cancel"},on:{"click":function($event){return _vm.$refs.dialog.close()}}},[_vm._v(_vm._s(_vm.$t("cancel")))]),_vm._v(" "),_c("k-button",{attrs:{"icon":"check","theme":"positive"},on:{"click":_vm.processImages}},[_vm._v("Process")])],1)],1)]:!_vm.processing&&_vm.failed.length?[_c("k-text",[_vm._v(" "+_vm._s(_vm.$t("colorextractor.dialog.text.error",{count:_vm.completedCount,failed:_vm.failed.length},_vm.completedCount))+" ")]),_vm._v(" "),_c("ul",{staticClass:"colorextractor-errors"},_vm._l(_vm.failed,function(obj,index){return _c("li",{staticClass:"error"},[_c("strong",[_vm._v("Filename:")]),_vm._v(" "+_vm._s(obj.name)+" "),_c("div",{staticClass:"error-message"},[_vm._v(_vm._s(obj.message))])])}),0),_vm._v(" "),_c("template",{slot:"footer"},[_c("k-button-group",[_c("k-button",{attrs:{"icon":"cancel"},on:{"click":function($event){return _vm.$refs.dialog.close()}}},[_vm._v(_vm._s(_vm.$t("close")))])],1)],1)]:_vm.processing?[_c("k-headline",[_vm._v(_vm._s(_vm.$t("colorextractor.dialog.processing")))]),_vm._v(" "),_c("k-progress",{ref:"progress"}),_vm._v(" "),_c("ul",{staticClass:"k-upload-list"},[_c("div",{staticClass:"colorextractor-progress-caption"},[_c("p",{staticClass:"k-colextractor-counter"},[_vm._v(_vm._s(_vm.$t("colorextractor.dialog.extracted"))+": "+_vm._s(_vm.completedCount)+" / "+_vm._s(_vm.count))])])]),_vm._v(" "),_c("template",{slot:"footer"},[_c("k-button-group",[_c("k-button",{attrs:{"icon":"cancel"},on:{"click":_vm.abortExtraction}},[_vm._v(_vm._s(_vm.$t("cancel")))])],1)],1)]:_vm._e()],2)],1)};var staticRenderFns=[];return{render:render,staticRenderFns:staticRenderFns,_compiled:true,_scopeId:null,functional:undefined}}());panel.plugin("sylvainjule/colorextractor",{fields:{colorextractor:a}});})();